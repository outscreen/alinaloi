11. Подпрограммы. Передача параметров. Ближние и дальние процедуры.

Подпрограммы на asm выз-ется командой call при этом выполн. сл. действия: -1-в стеке сохр. адрес сл. после call команды (для мал. моделей только регистр IP, большие – CS:IP).-2-В регистр CS:IP для больших моделей или IP загр. адрес точки входа в подпр.-3- посл. командой подпрогр. должна быть команда ret она загр. из стека адрес сл. после call команды.    my_proc PROC – имя процедуры---my_proc ENDP.  Для передачи параметров исп. 2 способа: - через регистр; - через стек; Также можно передавать копию аргумента или адрес аргумента. Команда CALL имеет 4 модификации: - вызов прямой ближний(в пределах текущего программного сегмента – near ptr):call near ptr proc1;- вызов косвенный ближний(word ptr): mov bx,offset proc1---call [bx];- прямой дальний вызов(вызов процедуры, расположенной в другом сегменте кода – far ptr): call far ptr proc1; - вызов косвенный дальний(dword ptr): adr dd proc1---call DS:adr(или call dword ptr adr).
.model small
.stack 100h
.code
start:
mov ax,12h
mov bx,2
call my_convert
mov ch,4ch
int 21h
my_convert PROC
push cx
……….
pop  dx 
pop   cx
ret
my_convert endp
end start